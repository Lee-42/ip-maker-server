# 环境与配置详解

本文档详细说明了 meme-server 项目的开发环境基础设施和后端核心配置，帮助开发者快速理解项目运行环境。

## 1. 开发环境基础设施 (`docker-compose.dev.yml`)

文件路径：`docker-compose.dev.yml`

该文件定义了项目运行所需的依赖服务，专为开发环境优化。通过 Docker Compose 可以一键启动所有依赖。

### 包含服务

#### MySQL (数据库服务)
- **版本**: 8.0
- **容器名称**: `meme-mysql`
- **端口映射**: `3306:3306`
- **环境变量**:
  - `MYSQL_DATABASE`: `hotgo`
  - `MYSQL_USER`: `leo`
  - `MYSQL_PASSWORD`: `jmqs18666` (开发环境预设密码)
  - `TZ`: `Asia/Shanghai`
- **特性**:
  - 挂载了 `./storage/init` 目录，容器首次启动时会自动执行其中的 SQL 脚本进行数据库初始化。
  - 针对开发环境调整了 `max_connections` 和 `innodb_buffer_pool_size`。

#### Redis (缓存服务)
- **版本**: 7-alpine (轻量版)
- **容器名称**: `meme-redis`
- **端口映射**: `6379:6379`
- **配置**:
  - 开启 AOF 持久化 (`appendonly yes`)。
  - 内存限制为 `128mb`，采用 `allkeys-lru` 淘汰策略，防止开发机资源占用过高。

### 使用方法

启动开发环境依赖：
```bash
docker-compose -f docker-compose.dev.yml up -d
```

---

## 2. 后端核心配置 (`server/manifest/config/config.yaml`)

文件路径：`server/manifest/config/config.yaml`

这是 HotGo 框架后端的核心配置文件，控制着应用的行为、连接信息和安全策略。

### 关键配置模块

#### 1. 系统基础 (System)
- **appName**: 应用名称。
- **mode**: 运行模式。开发环境通常设为 `"develop"`，生产环境设为 `"product"`。
- **debug**: 调试开关。开启后接口报错会返回详细堆栈信息。

#### 2. Web 服务 (Server)
- **address**: 监听地址，默认 `:8081`。
- **serverRoot**: 静态文件服务根目录。
- **openapiPath** / **swaggerPath**: 接口文档访问路径。

#### 3. 数据库与缓存 (Database & Redis)
- **database**: 配置 MySQL 连接字符串。默认连接本地 `3306` 端口的 `meme` 数据库。
- **redis**: 配置 Redis 连接信息。默认连接本地 `6379` 端口。

#### 4. 安全配置 (Token)
这是安全相关的核心配置，务必注意：
- **secretKey**: JWT 令牌加密密钥。
  - ⚠️ **安全警告**: 默认值为 `"hotgo123"`。**在生产环境中必须修改此值**，否则会导致严重的安全漏洞（如伪造身份）。
- **expires**: Token 有效期，默认 7 天。
- **multiLogin**: 是否允许多端登录。

#### 5. 代码生成 (HgGen)
配置 HotGo 代码生成器的行为：
- **allowedIPs**: 允许执行代码生成的 IP 白名单。
- **application**: 定义了 CRUD、消息队列等模块的生成模板路径和输出路径。
